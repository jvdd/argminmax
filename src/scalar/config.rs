// TODO: implement this generically (using efficient code fore floats and integers)